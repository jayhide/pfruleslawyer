# Preprocessing Configuration for Pathfinder 1e Rules Lawyer
#
# This file configures how markdown content is processed into searchable sections.
# See config/CLAUDE.md for detailed documentation.

# =============================================================================
# Disambiguation Rules
# =============================================================================
# Prevents title matches when ambiguous terms appear in specific contexts.
# Keys are lemmatized (lowercase) to match the title index format.
disambiguation_rules:
  medium:
    negative_contexts:
      - medium armor
      - medium size
      - size medium
      - medium creature
      - medium load
      - medium range
      - medium-size

# =============================================================================
# Category Weights
# =============================================================================
# Configure search behavior per category. YAML anchors reduce repetition.

category_weights:
  # Default weights for most content
  _default:
    semantic_weight: 1.0
    keyword_boost: 0.2
    subheading_boost: 0.2
    title_boost: 0.3
    rerank_weight: 0.3

  # Title-only categories - no embedding, fast title-based lookup
  # Used for categories where exact name matching is preferred
  _title_only: &title_only
    semantic_weight: 0.0
    keyword_boost: 0.0
    subheading_boost: 0.0
    title_boost: 1.0
    rerank_weight: 0.3

  # FAQ uses pure semantic matching
  FAQ:
    semantic_weight: 1.0
    keyword_boost: 0.0
    subheading_boost: 0.0
    title_boost: 0.0
    rerank_weight: 0.3

  # Classes use mixed semantic + title matching
  Classes:
    semantic_weight: 0.8
    keyword_boost: 0.2
    subheading_boost: 0.2
    title_boost: 0.5
    rerank_weight: 0.3

  # Title-only categories (reference the anchor)
  Spells: *title_only
  Feats: *title_only
  Archetypes: *title_only
  Magus Arcana: *title_only
  Rogue Talents: *title_only
  Arcanist Exploits: *title_only
  Alchemist Discoveries: *title_only
  Witch Hexes: *title_only
  Investigator Talents: *title_only
  Rage Powers: *title_only
  Sorcerer Bloodlines: *title_only
  Bloodrager Bloodlines: *title_only

# =============================================================================
# Entries
# =============================================================================
# URL patterns and their processing configuration.
#
# Entry types:
#   url: Single exact URL
#   urls: List of exact URLs
#   pattern: Glob pattern with * wildcard
#
# Processing modes:
#   full: LLM extracts multiple sections (for complex pages)
#   simple: LLM creates single section with summary
#   template: No LLM, template-based extraction (spells, feats, archetypes)
#   faq: No LLM, Q&A pair extraction
#   class: LLM extracts class features with TOC

entries:
  # ---------------------------------------------------------------------------
  # Skills
  # ---------------------------------------------------------------------------
  - url: https://www.d20pfsrd.com/skills/
    mode: full
    category: Skills
    name: Skills Overview

  - pattern: https://www.d20pfsrd.com/skills/*
    mode: simple
    category: Skills
    name_prefix: Skill
    exclude:
      - https://www.d20pfsrd.com/skills/
      - https://www.d20pfsrd.com/skills/alternate-crafting-rules/
      - https://www.d20pfsrd.com/skills/alternate-profession-rules/
      - https://www.d20pfsrd.com/skills/background-skills/
      - https://www.d20pfsrd.com/skills/consolidated-skills-optional-rules/
      - https://www.d20pfsrd.com/skills/grouped-skills/
      - https://www.d20pfsrd.com/skills/skill-challenges/
      # Exclude 3rd party content
      - https://www.d20pfsrd.com/skills/skills-from-other-publishers/
      - https://www.d20pfsrd.com/skills/skills-from-other-publishers/petersen-games-skills/
      - https://www.d20pfsrd.com/skills/skills-from-other-publishers/petersen-games-skills/profession-yog-sothothery-philosopher/
      - https://www.d20pfsrd.com/skills/craft/alternative-craft-rules-3pp/

  # ---------------------------------------------------------------------------
  # Spells
  # ---------------------------------------------------------------------------
  - pattern: https://www.d20pfsrd.com/magic/all-spells/*
    mode: template
    category: Spells
    name_prefix: Spell
    exclude_index_pages: true  # Auto-excludes /a/, /b/, ..., /z/ index pages

  # ---------------------------------------------------------------------------
  # Core Rules
  # ---------------------------------------------------------------------------
  - url: https://www.d20pfsrd.com/gamemastering/afflictions/
    mode: full
    category: Core Rules
    name: Afflictions (Curses, Diseases, Poisons)

  - url: https://www.d20pfsrd.com/gamemastering/combat/
    mode: full
    category: Core Rules
    name: Combat Rules

  - url: https://www.d20pfsrd.com/gamemastering/conditions/
    mode: full
    category: Core Rules
    name: Conditions

  - url: https://www.d20pfsrd.com/gamemastering/special-abilities/
    mode: full
    category: Core Rules
    name: Special Abilities

  - url: https://www.d20pfsrd.com/bestiary/rules-for-monsters/universal-monster-rules/
    mode: full
    category: Core Rules
    name: Universal Monster Rules

  - url: https://www.d20pfsrd.com/bestiary/rules-for-monsters/creature-types/
    mode: full
    category: Core Rules
    name: Creature Types & Subtypes

  - url: https://www.d20pfsrd.com/magic/
    mode: full
    category: Core Rules
    name: Magic Rules

  - url: https://www.d20pfsrd.com/basics-ability-scores/ability-scores/
    mode: full
    category: Core Rules
    name: Ability Scores

  - url: https://www.d20pfsrd.com/basics-ability-scores/glossary/
    mode: full
    category: Core Rules
    name: Glossary & Common Terms

  - url: https://www.d20pfsrd.com/gamemastering/exploration-movement/
    mode: full
    category: Core Rules
    name: Exploration & Movement

  - urls:
      - https://www.d20pfsrd.com/equipment/special-materials/
      - https://www.d20pfsrd.com/magic-items/wondrous-items/
      - https://www.d20pfsrd.com/magic-items/scrolls/
      - https://www.d20pfsrd.com/equipment/weapons/
      - https://www.d20pfsrd.com/equipment/armor/
      - https://www.d20pfsrd.com/magic-items/potions/
      - https://www.d20pfsrd.com/magic-items/rods/
      - https://www.d20pfsrd.com/magic-items/wands/
      - https://www.d20pfsrd.com/magic-items/staves/
    mode: full
    category: Core Rules

  - url: https://www.d20pfsrd.com/classes/core-classes/wizard/familiar/
    mode: full
    category: Core Rules
    name: Familiars

  - url: https://www.d20pfsrd.com/classes/core-classes/druid/animal-companions/
    mode: full
    category: Core Rules
    name: Animal Companions

  - url: https://www.d20pfsrd.com/classes/base-classes/summoner/eidolons/
    mode: full
    category: Core Rules
    name: Eidolons

  # ---------------------------------------------------------------------------
  # Classes
  # ---------------------------------------------------------------------------
  - urls:
      # Core Classes (using Unchained where available)
      - https://www.d20pfsrd.com/classes/unchained-classes/barbarian-unchained
      - https://www.d20pfsrd.com/classes/core-classes/bard/
      - https://www.d20pfsrd.com/classes/core-classes/cleric/
      - https://www.d20pfsrd.com/classes/core-classes/druid/
      - https://www.d20pfsrd.com/classes/core-classes/fighter/
      - https://www.d20pfsrd.com/classes/unchained-classes/monk-unchained/
      - https://www.d20pfsrd.com/classes/core-classes/paladin/
      - https://www.d20pfsrd.com/classes/core-classes/ranger/
      - https://www.d20pfsrd.com/classes/core-classes/sorcerer/
      - https://www.d20pfsrd.com/classes/core-classes/wizard/
      - https://www.d20pfsrd.com/classes/unchained-classes/rogue-unchained/
      # Alternate Classes
      - https://www.d20pfsrd.com/CLASSES/ALTERNATE-CLASSES/antipaladin/
      - https://www.d20pfsrd.com/CLASSES/ALTERNATE-CLASSES/ninja/
      - https://www.d20pfsrd.com/CLASSES/ALTERNATE-CLASSES/samurai/
      # Hybrid Classes
      - https://www.d20pfsrd.com/classes/hybrid-classes/arcanist/
      - https://www.d20pfsrd.com/classes/hybrid-classes/bloodrager/
      - https://www.d20pfsrd.com/classes/hybrid-classes/brawler/
      - https://www.d20pfsrd.com/classes/hybrid-classes/hunter/
      - https://www.d20pfsrd.com/classes/hybrid-classes/investigator/
      - https://www.d20pfsrd.com/classes/hybrid-classes/shaman/
      - https://www.d20pfsrd.com/classes/hybrid-classes/skald/
      - https://www.d20pfsrd.com/classes/hybrid-classes/slayer/
      - https://www.d20pfsrd.com/classes/hybrid-classes/swashbuckler/
      - https://www.d20pfsrd.com/classes/hybrid-classes/warpriest/
      - https://www.d20pfsrd.com/classes/unchained-classes/summoner-unchained
      # Base Classes
      - https://www.d20pfsrd.com/classes/base-classes/alchemist/
      - https://www.d20pfsrd.com/classes/base-classes/cavalier/
      - https://www.d20pfsrd.com/classes/base-classes/gunslinger/
      - https://www.d20pfsrd.com/classes/base-classes/inquisitor/
      - https://www.d20pfsrd.com/classes/base-classes/magus/
      - https://www.d20pfsrd.com/classes/base-classes/oracle/
      - https://www.d20pfsrd.com/classes/base-classes/shifter/
      - https://www.d20pfsrd.com/classes/base-classes/witch/
      - https://www.d20pfsrd.com/classes/base-classes/vigilante/
      - https://www.d20pfsrd.com/classes/base-classes/vampire-hunter/
    mode: class
    category: Classes
    name_prefix: Class

  # Prestige Classes - Core Rulebook
  - pattern: https://www.d20pfsrd.com/classes/prestige-classes/core-rulebook/*
    mode: class
    category: Classes
    name_prefix: Prestige Class
    exclude_index_pages: true

  # Prestige Classes - APG
  - pattern: https://www.d20pfsrd.com/classes/prestige-classes/apg/*
    mode: class
    category: Classes
    name_prefix: Prestige Class
    exclude_index_pages: true

  # Prestige Classes - Other Paizo (nested structure)
  - pattern: https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/*/*
    mode: class
    category: Classes
    name_prefix: Prestige Class
    exclude:
      # Index pages for alphabetical groupings
      - https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/a-b/
      - https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/c-d/
      - https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/e-h/
      - https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/i-m/
      - https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/n-r/
      - https://www.d20pfsrd.com/classes/prestige-classes/other-paizo/s-z/

  # ---------------------------------------------------------------------------
  # FAQ
  # ---------------------------------------------------------------------------
  - urls:
      - https://paizo.com/paizo/faq/v5748nruor1gw
      - https://paizo.com/paizo/faq/v5748nruor1fn
      - https://paizo.com/paizo/faq/v5748nruor1fm
      - https://paizo.com/paizo/faq/v5748nruor1g1
      - https://paizo.com/paizo/faq/v5748nruor1fz
    mode: faq
    category: FAQ
    name: Paizo FAQ

  # ---------------------------------------------------------------------------
  # Archetypes
  # ---------------------------------------------------------------------------
  - pattern: https://www.d20pfsrd.com/classes/*/archetypes/*paizo*/*
    mode: template
    category: Archetypes
    name_prefix: Archetype
    exclude:
      # Archetype index pages (listing pages, not actual archetypes)
      - "*/paizo-antipaladin-archetypes/"
      - "*/paizo-ninja-archetypes/"
      - "*/paizo-samurai-archetypes/"
      - "*/paizo-alchemist-archetypes/"
      - "*/paizo-cavalier-archetypes/"
      - "*/paizo-gunslinger-archetypes/"
      - "*/inquisitor-archetypes-paizo/"
      - "*/paizo-magus-archetypes/"
      - "*/paizo-oracle-archetypes/"
      - "*/paizo-summoner-archetypes/"
      - "*/vigilante-archetypes-paizo-inc/"
      - "*/paizo-witch-archetypes/"
      - "*/paizo-barbarian-archetypes/"
      - "*/paizo-bard-archetypes/"
      - "*/paizo-cleric-archetypes/"
      - "*/paizo-druid-archetypes/"
      - "*/paizo-fighter-archetypes/"
      - "*/paizo-monk-archetypes/"
      - "*/paizo-paladin-archetypes/"
      - "*/paizo-ranger-archetypes/"
      - "*/paizo-rogue-archetypes/"
      - "*/paizo-sorcerer-archetypes/"
      - "*/paizo-wizard-archetypes/"
      - "*/paizo-arcanist-archetypes/"
      - "*/paizo-bloodrager-archetypes/"
      - "*/paizo-brawler-archetypes/"
      - "*/paizo-hunter-archetypes/"
      - "*/paizo-investigator-archetypes/"
      - "*/paizo-shaman-archetypes/"
      - "*/paizo-skald-archetypes/"
      - "*/paizo-slayer-archetypes/"
      - "*/paizo-swashbuckler-archetypes/"
      - "*/paizo-warpriest-archetypes/"
      - "*/archetypes-paizo/"
      - "*/paizo-archetypes/"

  # ---------------------------------------------------------------------------
  # Feats
  # ---------------------------------------------------------------------------
  # Two-level deep feats (e.g., /feats/combat-feats/power-attack-combat/)
  - pattern: https://www.d20pfsrd.com/feats/*/*
    mode: template
    category: Feats
    name_prefix: Feat
    exclude:
      # Feat category index pages
      - https://www.d20pfsrd.com/feats/achievement-feats/
      - https://www.d20pfsrd.com/feats/animal-companion-feats/
      - https://www.d20pfsrd.com/feats/armor-mastery-feats/
      - https://www.d20pfsrd.com/feats/betrayal-feats/
      - https://www.d20pfsrd.com/feats/caravan-feats/
      - https://www.d20pfsrd.com/feats/channeling-feats/
      - https://www.d20pfsrd.com/feats/combat-feats/
      - https://www.d20pfsrd.com/feats/conduit-feats/
      - https://www.d20pfsrd.com/feats/damnation-feats/
      - https://www.d20pfsrd.com/feats/faction-feats/
      - https://www.d20pfsrd.com/feats/familiar-feats/
      - https://www.d20pfsrd.com/feats/feat-tree/
      - https://www.d20pfsrd.com/feats/feats-db/
      - https://www.d20pfsrd.com/feats/general-feats/
      - https://www.d20pfsrd.com/feats/grit-feats/
      - https://www.d20pfsrd.com/feats/item-creation-feats/
      - https://www.d20pfsrd.com/feats/item-mastery-feats/
      - https://www.d20pfsrd.com/feats/local-feats/
      - https://www.d20pfsrd.com/feats/metamagic-feats/
      - https://www.d20pfsrd.com/feats/monster-feats/
      - https://www.d20pfsrd.com/feats/other-feats/
      - https://www.d20pfsrd.com/feats/panache-feats/
      - https://www.d20pfsrd.com/feats/performance-feats/
      - https://www.d20pfsrd.com/feats/racial-feats/
      - https://www.d20pfsrd.com/feats/shield-mastery-feats/
      - https://www.d20pfsrd.com/feats/stare-feats/
      - https://www.d20pfsrd.com/feats/story-feats/
      - https://www.d20pfsrd.com/feats/style-feats/
      - https://www.d20pfsrd.com/feats/teamwork-feats/
      - https://www.d20pfsrd.com/feats/weapon-mastery-feats/

  # Three-level deep feats (racial feats are nested deeper)
  - pattern: https://www.d20pfsrd.com/feats/*/*/*
    mode: template
    category: Feats
    name_prefix: Feat

  # ---------------------------------------------------------------------------
  # Class Options (Talents, Arcana, Discoveries, etc.)
  # ---------------------------------------------------------------------------
  # Magus Arcana
  - pattern: https://www.d20pfsrd.com/classes/base-classes/magus/magus-arcana/paizo-magus-arcana/*
    mode: template
    category: Magus Arcana
    name_prefix: Magus Arcana
    exclude_index_pages: true

  # Rogue Talents
  - pattern: https://www.d20pfsrd.com/classes/core-classes/rogue/rogue-talents/paizo-rogue-talents/*
    mode: template
    category: Rogue Talents
    name_prefix: Rogue Talent
    exclude_index_pages: true

  # Advanced Rogue Talents
  - pattern: https://www.d20pfsrd.com/classes/core-classes/rogue/rogue-talents/paizo-rogue-advanced-talents/*
    mode: template
    category: Rogue Talents
    name_prefix: Advanced Rogue Talent
    exclude_index_pages: true

  # Arcanist Exploits
  - pattern: https://www.d20pfsrd.com/classes/hybrid-classes/arcanist/arcane-exploits/*
    mode: template
    category: Arcanist Exploits
    name_prefix: Arcanist Exploit
    exclude_index_pages: true

  # Greater Arcanist Exploits
  - pattern: https://www.d20pfsrd.com/classes/hybrid-classes/arcanist/arcanist-greater-exploits/*
    mode: template
    category: Arcanist Exploits
    name_prefix: Greater Arcanist Exploit
    exclude_index_pages: true

  # Alchemist Discoveries
  - pattern: https://www.d20pfsrd.com/classes/base-classes/alchemist/discoveries/paizo-alchemist-discoveries/*
    mode: template
    category: Alchemist Discoveries
    name_prefix: Alchemist Discovery
    exclude_index_pages: true

  # Witch Hexes - Common
  - pattern: https://www.d20pfsrd.com/classes/base-classes/witch/hexes/hexes/common-hexes/*
    mode: template
    category: Witch Hexes
    name_prefix: Witch Hex
    exclude_index_pages: true

  # Witch Hexes - Major
  - pattern: https://www.d20pfsrd.com/classes/base-classes/witch/hexes/hexes/major-hexes/*
    mode: template
    category: Witch Hexes
    name_prefix: Major Witch Hex
    exclude_index_pages: true

  # Witch Hexes - Grand
  - pattern: https://www.d20pfsrd.com/classes/base-classes/witch/hexes/hexes/grand-hexes/*
    mode: template
    category: Witch Hexes
    name_prefix: Grand Witch Hex
    exclude_index_pages: true

  # Investigator Talents
  - pattern: https://www.d20pfsrd.com/classes/hybrid-classes/investigator/investigator-talents/paizo-investigator-talents/*
    mode: template
    category: Investigator Talents
    name_prefix: Investigator Talent
    exclude_index_pages: true

  # Rage Powers
  - pattern: https://www.d20pfsrd.com/classes/core-classes/barbarian/rage-powers/paizo-rage-powers/*
    mode: template
    category: Rage Powers
    name_prefix: Rage Power
    exclude_index_pages: true

  # Sorcerer Bloodlines
  - pattern: https://www.d20pfsrd.com/classes/core-classes/sorcerer/bloodlines/bloodlines-from-paizo/*
    mode: template
    category: Sorcerer Bloodlines
    name_prefix: Sorcerer Bloodline
    exclude_index_pages: true

  # Bloodrager Bloodlines
  - pattern: https://www.d20pfsrd.com/classes/hybrid-classes/bloodrager/bloodrager-bloodlines/paizo-bloodrager-bloodlines/*
    mode: template
    category: Bloodrager Bloodlines
    name_prefix: Bloodrager Bloodline
    exclude_index_pages: true
